<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Printer Selection</title>
    <script src="BrowserPrint-3.1.250.min.js" defer></script>
    <script src="BrowserPrint-Zebra-1.1.250.min.js" defer></script>
    <script src="printerSelection.js" defer></script>
</head>
<body>
    <h1>Select Printer</h1>
    <select id="selected_device">
        <option value="">Choose a printer</option>
    </select>
    <button onclick="getConfig()">Get Printer Config</button>

    <script>
        var selected_device;
        var devices = [];

        // Function to get devices and add them to the list
        BrowserPrint.getDefaultDevice("printer", function(device) {
            selected_device = device;
            devices.push(device);
            var html_select = document.getElementById("selected_device");
            var option = document.createElement("option");
            option.text = device.name;
            html_select.add(option);

            // Discover any other devices available to the application
            BrowserPrint.getLocalDevices(function(device_list) {
                for (var i = 0; i < device_list.length; i++) {
                    var device = device_list[i];
                    if (!selected_device || device.uid != selected_device.uid) {
                        devices.push(device);
                        var option = document.createElement("option");
                        option.text = device.name;
                        option.value = device.uid;
                        html_select.add(option);
                    }
                }
            }, function() {
                alert("Error getting local devices");
            }, "printer");
        }, function(error) {
            alert(error);
        });

        // Function to get printer configuration
        function getConfig() {
            BrowserPrint.getApplicationConfiguration(function(config) {
                alert(JSON.stringify(config));
            }, function(error) {
                alert(JSON.stringify(new BrowserPrint.ApplicationConfiguration()));
            });
        }
    </script>
</body>
</html>